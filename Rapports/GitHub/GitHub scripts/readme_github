# Supervision Prometheus & Exporters â€” Infrastructure SÃ©curisÃ©e

## ğŸ“Œ Objectif

Ce projet met en place un systÃ¨me complet de supervision rÃ©seau et systÃ¨me avec :

- Prometheus
- Node Exporter
- Blackbox Exporter
- Telegraf
- IntÃ©gration Grafana (optionnelle)
- Automatisation via `Makefile`
- DÃ©ploiement possible via Terraform + GitHub Actions

---

## ğŸ—‚ï¸ Structure du dÃ©pÃ´t

.
â”œâ”€â”€ Makefile
â”œâ”€â”€ install_prometheus.sh
â”œâ”€â”€ install_exporters.sh
â”œâ”€â”€ check_and_restart_services.sh
â”œâ”€â”€ verify_ports_exporters.sh
â”œâ”€â”€ prometheus/
â”‚ â”œâ”€â”€ prometheus.yml
â”‚ â””â”€â”€ alert.rules.yml
â””â”€â”€ README.md


---

## âš™ï¸ PrÃ©requis

- SystÃ¨me Ubuntu 20.04 ou 22.04
- Prometheus â‰¥ 2.50
- `promtool`, `curl`, `ss`
- Droits `sudo`

---

## ğŸš€ Installation en 2 Ã©tapes

```bash
make install_prometheus
make install_exporters


âœ… VÃ©rification et Validation

```bash
make validate           # VÃ©rifie les fichiers YAML
make reload             # Recharge la conf Prometheus
make check_services     # VÃ©rifie les services
make verify             # Affiche les ports Ã©coutÃ©s + targets actives


ğŸ”„ RedÃ©marrage

```bash
make restart

Description des scripts

| Script                          | RÃ´le                                               |
| ------------------------------- | -------------------------------------------------- |
| `install_prometheus.sh`         | Installe Prometheus et configure son service       |
| `install_exporters.sh`          | Installe node\_exporter et blackbox\_exporter      |
| `verify_ports_exporters.sh`     | VÃ©rifie si les bons ports sont Ã©coutÃ©s et visibles |
| `check_and_restart_services.sh` | Relance les services sâ€™ils ne sont pas actifs      |


Branches Git recommandÃ©es

| Branche   | RÃ´le                                              |
| --------- | ------------------------------------------------- |
| `main`    | Version de production                             |
| `preprod` | Configuration en prÃ©production                    |
| `test`    | Tests unitaires ou ajout de modules expÃ©rimentaux |

SÃ©curitÃ© rÃ©seau

    Blackbox Exporter est configurÃ© pour :

        HTTP 2xx

        Ping ICMP

        RÃ©solution DNS

        Test de port TCP

        BanniÃ¨re SSH

    Tous les remplacements localhost â†’ 127.0.0.1 sont conseillÃ©s pour Ã©viter les conflits IPv6.


VÃ©rification des targets Prometheus

AccÃ¨s Ã  la liste des cibles : http://localhost:9091/-/targets

 Exemple de dÃ©ploiement via Terraform + Makefile

    Instancier la VM via Terraform

    git clone du dÃ©pÃ´t

    Lancer la configuration :

    ```bash
    make install_prometheus
    make install_exporters
    make validate
    make reload

 Test des modules Blackbox

Ajoutez des cibles dans prometheus.yml sous :

   ```yaml
job_name: 'blackbox_exporter_http'
params:
  module: [http_2xx]
static_configs:
  - targets:
      - https://www.google.com


Support

Ce dÃ©pÃ´t est prÃªt Ã  Ãªtre clonÃ© dans un environnement pro.
En cas de problÃ¨me : consulter les logs Prometheus et utiliser make verify pour diagnostiquer.

Licence

Projet sous licence MIT ou CC-BY-SA selon votre politique de sÃ©curitÃ©.
